<!DOCTYPE html>
<html lang="en">
<head>
	<title>Title</title>
	<meta charset="UTF-8">
	<meta name="viewport"
	      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	
	<link rel="stylesheet" href="css/style.css">
	<script src="https://code.jquery.com/jquery-3.3.1.js" defer></script>
	<script src="js/script.js"></script>
</head>
<body>

<script>
	function setTable(data) {
		let topRecords = JSON.parse(data);
		
		console.log(topRecords);
		
		let previousRecord = null;
		
		let theSame = [];
		
		for (let i = 0; i < topRecords.length; i++) {
			if (previousRecord !== null) {
				if (topRecords[i].score === previousRecord.score) {
					if (theSame.length === 0) {
						theSame.push(i - 1);
					}
					theSame.push(i);
				} else {
					if (theSame.length !== 0) {
						// Sorting by time
						sort(topRecords, theSame[0], theSame[theSame.length - 1]);
						
						theSame = [];
					}
				}
			}
			
			previousRecord = topRecords[i];
		}
		
		table.fadeIn(250);
	}
	
	function sort(arr, start, end) {
		for (let i = start; i <= end; i++) {
			let minIndex = i;
			
			for (let j = i + 1; j < end; j++) {
				if (new Date(Date.parse(swapDayAndMonth(arr[j].time))) < new Date(Date.parse(swapDayAndMonth(arr[minIndex].time)))) {
					i = j;
				}
			}
			
			if (minIndex !== i) {
				[arr[i], arr[minIndex]] = [arr[i], arr[minIndex]];
			}
		}
		
		console.log(arr);
	}
	
	setTable('[{"username":"username","score":"1234","time":"31.10.18"},{"username":"username22","score":"555","time":"31.10.18"},{"username":"dfgs","score":"555","time":"18.10.18"},{"username":"dfgs","score":"555","time":"15.12.19"},{"username":"username22","score":"300","time":"31.10.18"},{"username":"any name","score":"300","time":"30.09.18"},{"username":"dfgs","score":"300","time":"01.11.18"},{"username":"dfgs","score":"300","time":"05.11.18"},{"username":"dfgs","score":"300","time":"03.11.18"},{"username":"username22","score":"99","time":"31.10.18"}]');
</script>

</body>
</html>
